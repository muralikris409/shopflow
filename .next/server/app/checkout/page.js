(()=>{var e={};e.id=279,e.ids=[279],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},83997:e=>{"use strict";e.exports=require("tty")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},1181:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=t(70260),o=t(28203),a=t(25155),n=t.n(a),l=t(67292),i={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);t.d(r,i);let d=["",{children:["checkout",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,57734)),"/home/murali/Documents/Cloning task/shopflow/src/app/checkout/page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,37043)),"/home/murali/Documents/Cloning task/shopflow/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(t.bind(t,26420)),"/home/murali/Documents/Cloning task/shopflow/src/app/not-found.js"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/home/murali/Documents/Cloning task/shopflow/src/app/checkout/page.js"],u={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:o.RouteKind.APP_PAGE,page:"/checkout/page",pathname:"/checkout",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},21135:(e,r,t)=>{Promise.resolve().then(t.bind(t,57734))},29383:(e,r,t)=>{Promise.resolve().then(t.bind(t,15831))},31857:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(45512),o=t(79334),a=t(58009),n=t(92273);let l=e=>r=>{let t=(0,o.useRouter)(),l=(0,n.d4)(e=>e.session.user),[i,d]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{void 0!==l&&d(!1)},[l]),(0,a.useEffect)(()=>{i||l||t.push("/auth")},[i,l,t]),i)?(0,s.jsx)("div",{children:"Loading......."}):l?(0,s.jsx)(e,{...r}):null}},15831:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>h});var s=t(45512),o=t(58009),a=t(85209);let n=async e=>{console.log("orderid:",e);try{return(await a.S.post(`/user/order/failedVerify?orderId=${e}`)).data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}};var l=t(613),i=t(79334);let d=({title:e,steps:r,userId:t,orders:a,shippingMethods:d,billingAddress:c,totalBill:u})=>{let m=(0,i.useRouter)(),[p,h]=(0,o.useState)(!1),[x,g]=(0,o.useState)(null),[f,y]=(0,o.useState)(a?.orders?.order?.items||a?.orders?.items),[b,v]=(0,o.useState)({fullName:"",streetAddress:"",city:"",state:"",zip:"",country:""}),[w,j]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=document.createElement("script");return e.src="https://checkout.razorpay.com/v1/checkout.js",e.onload=()=>{},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[t]);let N=()=>{let{fullName:e,streetAddress:r,city:t,state:s,zip:o,country:a}=b;j(e&&r&&t&&s&&o&&a)},C=e=>{let{name:r,value:t}=e.target;v(e=>({...e,[r]:t}))},k=async(e,r,t,s)=>{console.log(r,t,s);try{return await (0,l.yT)(e,r,t,s)}catch(e){g("Payment verification failed. Please try again."),console.error(JSON.stringify(e))}},P=async()=>{if(!w){g("Please fill all the required fields.");return}h(!0),g(null);try{let{razorpayOrder:e,...r}=await (0,l.TU)(a?.orders?.order?.id||a?.orders.id),t={key:"rzp_test_nTbKdtgjeOQLhc",amount:Math.ceil(100*u),currency:e?.currency,name:"Your Shop",description:"Payment for your order",order_id:e?.id,handler:async function(e){let{razorpay_payment_id:r,razorpay_signature:t,razorpay_order_id:s}=e,o=await k(a?.orders?.order?.id||a?.orders.id,s,r,t);o.success?m.push(`/orders/success?dtrcpt=${encodeURIComponent(JSON.stringify(o?.order))}`):(console.log("failed"),await n(a?.orders?.order?.id||a?.orders.id),g("Payment verification failed. Please try again."))},prefill:{name:b.fullName,email:"customer@example.com",contact:"1234567890"},theme:{color:"#F37254"}};new window.Razorpay(t).open()}catch(e){g("Payment process failed. Please try again."),console.error("Payment process failed:",e)}finally{h(!1)}};return(0,s.jsxs)("div",{children:[x&&(0,s.jsx)("div",{className:"bg-red-500 text-white p-4 rounded mb-4",children:x}),(0,s.jsxs)("div",{className:"flex flex-col items-center border-b bg-white py-4 sm:flex-row sm:px-10 lg:px-20 xl:px-32",children:[(0,s.jsx)("a",{href:"#",className:"text-2xl font-bold text-gray-800",children:e}),(0,s.jsx)("div",{className:"mt-4 py-2 text-xs sm:mt-0 sm:ml-auto sm:text-base",children:(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("ul",{className:"relative flex w-full items-center justify-between space-x-2 sm:space-x-4",children:r.map((e,r)=>(0,s.jsxs)("li",{className:"flex items-center space-x-3 text-left sm:space-x-4",children:[(0,s.jsx)("a",{className:`flex h-6 w-6 items-center justify-center rounded-full text-xs font-semibold ${e.active?"bg-emerald-200 text-emerald-700":"bg-gray-600 text-white"}`,href:e.href,children:e.icon?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:e.iconPath})}):e.number}),(0,s.jsx)("span",{className:`font-semibold ${e.active?"text-gray-900":"text-gray-500"}`,children:e.label})]},r))})})})]}),(0,s.jsxs)("div",{className:"grid sm:px-10 lg:grid-cols-2 lg:px-20 xl:px-32 m-10",children:[(0,s.jsxs)("div",{className:"px-4 pt-8",children:[(0,s.jsx)("p",{className:"text-xl font-medium",children:"Order Summary"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Check your items. And select a suitable shipping method."}),(0,s.jsx)("div",{className:"mt-8 space-y-2 max-h-96 overflow-y-scroll rounded-lg border bg-white px-2 py-4 sm:px-6",children:f?.map((e,r)=>s.jsxs("div",{className:"flex flex-col rounded-lg bg-white sm:flex-row",children:[s.jsx("img",{className:"m-2 h-24 w-28 rounded-md border object-cover object-center",src:e.product?.image||"/_assets/image.png",alt:e.product?.name||"Product Image"}),s.jsxs("div",{className:"flex w-full flex-col px-4 py-4",children:[s.jsx("span",{className:"font-semibold",children:e?.product.name||"Product Name"}),s.jsx("span",{className:"float-right text-gray-400",children:e.product?.description||"No description available."}),s.jsx("span",{className:"float-right text-gray-400",children:"Quantity: "+(e.quantity||1)}),s.jsx("p",{className:"text-lg font-bold",children:"$"+(e.product?.offerPrice||"0.00")})]})]},r))}),(0,s.jsx)("p",{className:"text-lg p-2",children:"Total Bill: $"+u}),(0,s.jsx)("p",{className:"mt-8 text-lg font-medium",children:"Shipping Methods"}),(0,s.jsx)("form",{className:"mt-5 grid gap-6",children:d.map((e,r)=>(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{className:"peer hidden",id:`radio_${r}`,type:"radio",name:"radio",defaultChecked:e.defaultChecked}),(0,s.jsx)("span",{className:"peer-checked:border-gray-700 absolute right-4 top-1/2 box-content block h-3 w-3 -translate-y-1/2 rounded-full border-8 border-gray-300 bg-white"}),(0,s.jsxs)("label",{className:"peer-checked:border-2 peer-checked:border-gray-700 peer-checked:bg-gray-50 flex cursor-pointer select-none rounded-lg border border-gray-300 p-4",htmlFor:`radio_${r}`,children:[(0,s.jsx)("img",{className:"w-14 object-contain",src:e.image,alt:e.name}),(0,s.jsxs)("div",{className:"ml-5",children:[(0,s.jsx)("span",{className:"mt-2 font-semibold",children:e.name}),(0,s.jsx)("p",{className:"text-slate-500 text-sm leading-6",children:e.description})]})]})]},r))})]}),(0,s.jsxs)("div",{className:"mt-10 bg-gray-50 px-4 pt-8 lg:mt-0",children:[(0,s.jsx)("p",{className:"text-xl font-medium",children:"Address Details"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Complete your order by providing your delivery address."}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"full-name",className:"mt-4 mb-2 block text-sm font-medium",children:"Full Name"}),(0,s.jsx)("input",{type:"text",id:"full-name",name:"fullName",className:"w-full rounded-md border border-gray-200 px-4 py-3 text-sm shadow-sm outline-none focus:z-10 focus:border-blue-500 focus:ring-blue-500",placeholder:"John Doe",value:b.fullName,onChange:C,onBlur:N}),(0,s.jsx)("label",{htmlFor:"street-address",className:"mt-4 mb-2 block text-sm font-medium",children:"Street Address"}),(0,s.jsx)("input",{type:"text",id:"street-address",name:"streetAddress",className:"w-full rounded-md border border-gray-200 px-4 py-3 text-sm shadow-sm outline-none focus:z-10 focus:border-blue-500 focus:ring-blue-500",placeholder:"123 Main St",value:b.streetAddress,onChange:C,onBlur:N}),(0,s.jsx)("label",{htmlFor:"city",className:"mt-4 mb-2 block text-sm font-medium",children:"City"}),(0,s.jsx)("input",{type:"text",id:"city",name:"city",className:"w-full rounded-md border border-gray-200 px-4 py-3 text-sm shadow-sm outline-none focus:z-10 focus:border-blue-500 focus:ring-blue-500",placeholder:"Los Angeles",value:b.city,onChange:C,onBlur:N}),(0,s.jsx)("label",{htmlFor:"state",className:"mt-4 mb-2 block text-sm font-medium",children:"State/Province"}),(0,s.jsx)("input",{type:"text",id:"state",name:"state",className:"w-full rounded-md border border-gray-200 px-4 py-3 text-sm shadow-sm outline-none focus:z-10 focus:border-blue-500 focus:ring-blue-500",placeholder:"California",value:b.state,onChange:C,onBlur:N}),(0,s.jsx)("label",{htmlFor:"zip",className:"mt-4 mb-2 block text-sm font-medium",children:"ZIP/Postal Code"}),(0,s.jsx)("input",{type:"text",id:"zip",name:"zip",className:"w-full rounded-md border border-gray-200 px-4 py-3 text-sm shadow-sm outline-none focus:z-10 focus:border-blue-500 focus:ring-blue-500",placeholder:"90001",value:b.zip,onChange:C,onBlur:N}),(0,s.jsx)("label",{htmlFor:"country",className:"mt-4 mb-2 block text-sm font-medium",children:"Country"}),(0,s.jsx)("input",{type:"text",id:"country",name:"country",className:"w-full rounded-md border border-gray-200 px-4 py-3 text-sm shadow-sm outline-none focus:z-10 focus:border-blue-500 focus:ring-blue-500",placeholder:"United States",value:b.country,onChange:C,onBlur:N})]})]})]}),(0,s.jsx)("div",{className:"mt-10 text-center",children:(0,s.jsx)("button",{className:`w-3/4 rounded-lg ${p?"bg-gray-500":"bg-gray-900"} p-4 text-sm font-medium text-white`,disabled:p,onClick:P,children:p?"Processing...":"Proceed to Payment"})})]})};var c=t(26336),u=t(92273),m=t(31857);let p={title:"Order Summary",steps:[{number:1,label:"Cart",active:!0,href:"#",icon:null,iconPath:""},{number:2,label:"Shipping",active:!1,href:"#",icon:null,iconPath:""},{number:3,label:"Payment",active:!1,href:"#",icon:null,iconPath:""}],shippingMethods:[{name:"Standard Shipping",description:"5-7 business days",image:"https://via.placeholder.com/50",defaultChecked:!0},{name:"Express Shipping",description:"2-3 business days",image:"https://via.placeholder.com/50",defaultChecked:!1}],billingAddress:{placeholder:"Enter your address",flag:"https://via.placeholder.com/20",states:["California","Texas","New York"],countries:["USA","Canada","UK"]}},h=(0,m.A)(function(){let[e,r]=(0,o.useState)([]),[t,a]=(0,o.useState)(!0),n=(new c.A,(0,u.d4)(e=>e.session.user?.id)),l=JSON.parse((0,i.useSearchParams)().get("data"))||[];return t?(0,s.jsx)("div",{children:"Loading..."}):(0,s.jsx)(d,{title:p.title,steps:p.steps,data:e.items,userId:n,orders:l,totalBill:e.totalAmount,shippingMethods:p.shippingMethods,billingAddress:p.billingAddress})})},613:(e,r,t)=>{"use strict";t.d(r,{N4:()=>i,TU:()=>n,fS:()=>o,gY:()=>l,yT:()=>a});var s=t(85209);let o=async(e,r)=>{try{return(await s.S.post("/user/order/createOrder",{userId:e,items:r})).data}catch(e){throw console.error("Error creating order:",e),Error(e?.response?.data?.message||"Error creating order.")}},a=async(e,r,t,o)=>{console.log("order_id:",e),console.log("razorpayId:",r),console.log("paymentId:",t),console.log("siign:",o);try{return(await s.S.post("/user/order/verify",{},{params:{orderId:e,razorpayId:r,paymentId:t,paymentSignature:o}})).data}catch(e){throw console.error("Error verifying payment:",e),Error(e?.response?.data?.message||"Error verifying payment.")}},n=async e=>{console.log("orderid:",e);try{return(await s.S.post(`/user/order/checkoutOrder?orderId=${e}`)).data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}},l=async e=>{console.log("userId:",e);try{return(await s.S.get(`/user/order/getUserOrder?userId=${e}`)).data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}},i=async e=>{console.log(e);try{return(await s.S.put(`/user/order/cancelOrder?orderId=${e}`)).data}catch(e){throw console.error("Error cancelling order:",e),Error(e?.response?.data?.message||"Error cancelling order.")}}},26336:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(92273),o=t(85209);let a=function(){let e=(0,s.d4)(e=>e.session.token),r="shopflow",t=()=>({Authorization:`Bearer ${e}`,"Content-Type":"application/json"});this.loadCart=function(){let e=localStorage.getItem(r);return e?JSON.parse(e):[]},this.saveCart=function(e){localStorage.setItem(r,JSON.stringify(e))},this.migrateCart=async function(e){let r=this.loadCart();if(r.length>0){for(let t of r)try{await this.addItemToCart(e,t.productId,t.quantity)}catch(e){console.error("Error migrating cart item:",e)}this.clearCart()}},this.addItemToCart=async function(e,r,s=1){console.log(e),console.log(r);try{return(await o.S.post("/user/cart/addItemToCart",{},{params:{userId:e,productId:r,quantity:s},headers:t()})).data}catch(e){throw console.error("Error adding item to cart:",e),e.response?e.response.data:Error("Network or server error")}},this.viewCart=async function(e){try{let r=await o.S.get("/user/cart/viewCart",{params:{userId:e},headers:t()});if(200===r.status)return r.data.data||[];throw Error(r.data.message||"Failed to retrieve cart")}catch(e){throw console.error("Error viewing cart:",e),e.response?e.response.data:Error("Network or server error")}},this.deleteFromCart=async function(e,r){try{let s=await o.S.delete("/user/cart/deleteFromCart",{params:{userId:e,productId:r},headers:t()});if(200===s.status)return s.data;throw Error(s.data.message||"Failed to delete item from cart")}catch(e){throw console.error("Error deleting item from cart:",e),e.response?e.response.data:Error("Network or server error")}},this.updateCartCount=async function(e,r,s){try{let a=await o.S.put("/user/cart/cartCount",{},{params:{userId:e,productId:r,operation:s},headers:t()});if(console.log(a.status),200===a.status)return a.data;throw Error(a.data||"Failed to update cart count")}catch(e){throw console.error("Error updating cart count:",e),e}},this.clearCart=function(){localStorage.removeItem(r)}}},57734:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/murali/Documents/Cloning task/shopflow/src/app/checkout/page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/murali/Documents/Cloning task/shopflow/src/app/checkout/page.js","default")}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,803,140],()=>t(1181));module.exports=s})();