(()=>{var e={};e.id=778,e.ids=[778],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},83997:e=>{"use strict";e.exports=require("tty")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},53593:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=t(70260),o=t(28203),a=t(25155),n=t.n(a),i=t(67292),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(r,l);let d=["",{children:["orders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,2773)),"/home/murali/Documents/Cloning task/shopflow/src/app/orders/page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,37043)),"/home/murali/Documents/Cloning task/shopflow/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(t.bind(t,26420)),"/home/murali/Documents/Cloning task/shopflow/src/app/not-found.js"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/home/murali/Documents/Cloning task/shopflow/src/app/orders/page.js"],u={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:o.RouteKind.APP_PAGE,page:"/orders/page",pathname:"/orders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},39864:(e,r,t)=>{Promise.resolve().then(t.bind(t,2773))},49592:(e,r,t)=>{Promise.resolve().then(t.bind(t,73353))},31857:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(45512),o=t(79334),a=t(58009),n=t(92273);let i=e=>r=>{let t=(0,o.useRouter)(),i=(0,n.d4)(e=>e.session.user),[l,d]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{void 0!==i&&d(!1)},[i]),(0,a.useEffect)(()=>{l||i||t.push("/auth")},[l,i,t]),l)?(0,s.jsx)("div",{children:"Loading......."}):i?(0,s.jsx)(e,{...r}):null}},73353:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var s=t(45512),o=t(58009),a=t(613),n=t(92273),i=t(31857);let l=({order:e,onCancel:r})=>(console.log(e),(0,s.jsx)("section",{className:"bg-white py-5 text-gray-700 sm:py-5 lg:py-5  overflow-y-hidden",children:(0,s.jsxs)("div",{className:"mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-4",children:[(0,s.jsx)("div",{className:"mx-auto max-w-md text-center mb-4",children:(0,s.jsxs)("h2",{className:"font-serif text-2xl font-bold sm:text-3xl",children:["Order ID ",(0,s.jsxs)("span",{className:"text-gray-500",children:["# ",e.id]})]})}),(0,s.jsx)("div",{className:"mt-10 grid grid-cols-1 gap-6 lg:grid-cols-1 lg:gap-4",children:(0,s.jsxs)("article",{className:"relative p-4 border rounded-lg shadow-md bg-white",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-bold",children:"Order Status"}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsx)("p",{className:`text-sm ${"OnDeliver"===e.orderStatus?"text-green-500":"text-red-500"}`,children:e.orderStatus})})]}),(0,s.jsx)("div",{className:"flex justify-between items-center mb-2",children:"CANCELLED"!==e.orderStatus&&(0,s.jsx)("button",{className:"px-4 py-1 bg-red-500 text-white rounded hover:bg-red-700 transition-colors duration-200",onClick:()=>{r(e.id)},children:"Cancel"})}),(0,s.jsx)("div",{className:"flex items-center space-x-4 mt-4 overflow-x-auto scroll-smooth",children:e.items.map(e=>(0,s.jsxs)("div",{className:"flex flex-col items-center min-w-[200px]",children:[(0,s.jsx)("div",{className:"aspect-square w-full overflow-hidden",children:(0,s.jsx)("img",{src:e.product.imageUrl||"/_assets/image.png",alt:e.product.name,className:"group-hover:scale-110 h-full w-full object-cover transition-all duration-300 rounded-md"})}),(0,s.jsx)("p",{className:"text-sm font-semibold text-center mt-2",children:e.product.name}),(0,s.jsxs)("p",{className:"text-sm text-center",children:["Rp ",e.price.toLocaleString()," x ",e.quantity]})]},e.id))}),(0,s.jsxs)("p",{className:"mt-4 font-bold text-lg",children:["Total: Rp ",e.totalAmount.toLocaleString()]}),"Cancelled"===e.orderStatus&&(0,s.jsx)("p",{className:"mt-2 text-red-500 font-semibold",children:"Order Cancelled"})]})})]})})),d=(0,i.A)(()=>{let[e,r]=(0,o.useState)([]),[t,i]=(0,o.useState)(!0),[d,c]=(0,o.useState)(null),u=(0,n.d4)(e=>e.session.user?.id);(0,o.useEffect)(()=>{(async()=>{if(u)try{i(!0);let e=await (0,a.gY)(u);r(e.orders||[])}catch(e){c(e?.message||"An error occurred")}finally{i(!1)}})()},[u]);let p=async e=>{try{await (0,a.N4)(e),r(r=>r.map(r=>r.id===e?{...r,orderStatus:"Cancelled"}:r))}catch(e){c(e?.message||"Failed to cancel order")}finally{}};return t?(0,s.jsx)("div",{className:"text-center text-lg",children:"Loading..."}):d?(0,s.jsxs)("div",{className:"text-red-500 text-center text-lg",children:["Error: ",d]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6 text-center",children:"My Orders"}),(0,s.jsx)("div",{className:"container mx-auto p-4 max-h-lvh overflow-y-scroll my-10",children:(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4",children:e.map(e=>(0,s.jsx)(l,{order:e,onCancel:p},e.id))})})]})})},613:(e,r,t)=>{"use strict";t.d(r,{N4:()=>l,TU:()=>n,fS:()=>o,gY:()=>i,yT:()=>a});var s=t(85209);let o=async(e,r)=>{try{return(await s.S.post("/user/order/createOrder",{userId:e,items:r})).data}catch(e){throw console.error("Error creating order:",e),Error(e?.response?.data?.message||"Error creating order.")}},a=async(e,r,t,o)=>{console.log("order_id:",e),console.log("razorpayId:",r),console.log("paymentId:",t),console.log("siign:",o);try{return(await s.S.post("/user/order/verify",{},{params:{orderId:e,razorpayId:r,paymentId:t,paymentSignature:o}})).data}catch(e){throw console.error("Error verifying payment:",e),Error(e?.response?.data?.message||"Error verifying payment.")}},n=async e=>{console.log("orderid:",e);try{return(await s.S.post(`/user/order/checkoutOrder?orderId=${e}`)).data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}},i=async e=>{console.log("userId:",e);try{return(await s.S.get(`/user/order/getUserOrder?userId=${e}`)).data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}},l=async e=>{console.log(e);try{return(await s.S.put(`/user/order/cancelOrder?orderId=${e}`)).data}catch(e){throw console.error("Error cancelling order:",e),Error(e?.response?.data?.message||"Error cancelling order.")}}},2773:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/murali/Documents/Cloning task/shopflow/src/app/orders/page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/murali/Documents/Cloning task/shopflow/src/app/orders/page.js","default")}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,803,140],()=>t(53593));module.exports=s})();