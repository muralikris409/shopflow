(()=>{var e={};e.id=5,e.ids=[5],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},83997:e=>{"use strict";e.exports=require("tty")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},4513:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var a=t(70260),s=t(28203),o=t(25155),n=t.n(o),i=t(67292),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(r,l);let c=["",{children:["cart",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,14168)),"/home/murali/Documents/Cloning task/shopflow/src/app/cart/page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,69998)),"/home/murali/Documents/Cloning task/shopflow/src/app/layout.js"],loading:[()=>Promise.resolve().then(t.bind(t,18988)),"/home/murali/Documents/Cloning task/shopflow/src/app/loading.js"],"not-found":[()=>Promise.resolve().then(t.bind(t,26420)),"/home/murali/Documents/Cloning task/shopflow/src/app/not-found.js"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/home/murali/Documents/Cloning task/shopflow/src/app/cart/page.js"],u={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/cart/page",pathname:"/cart",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},85525:(e,r,t)=>{Promise.resolve().then(t.bind(t,14168))},27381:(e,r,t)=>{Promise.resolve().then(t.bind(t,17797))},17797:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>h});var a=t(45512),s=t(58009),o=t(13319),n=t(26336),i=t(92273),l=t(79334),c=t(613),d=t(65357);let u=()=>{let[e,r]=(0,s.useState)([]),[t,u]=(0,s.useState)(0),[h,m]=(0,s.useState)(null),[g,x]=(0,s.useState)(!1),[y,f]=(0,s.useState)(!0),w=(0,i.wA)(),v=new n.A,j=(0,i.d4)(e=>e.session.user),b=(0,l.useRouter)();(0,s.useEffect)(()=>{(async()=>{f(!0);try{if(j){let e=await v.viewCart(j.id);r(e.items),u(e.totalAmount)}else r([])}catch(e){m("Failed to load cart. Please try again later.")}finally{f(!1)}})()},[j]);let C=async(e,t)=>{try{if(t(!0),j){await v.updateCartCount(j.id,e,"increase");let t=await v.viewCart(j.id);r(t.items),u(t.totalAmount)}else(0,o.o7)(e),r((0,o.Xl)())}catch(e){m("Failed to update item quantity. Please try again later.")}finally{t(!1)}},N=async(e,t)=>{try{if(t(!0),j){await v.updateCartCount(j.id,e,"decrease");let t=await v.viewCart(j.id);r(t.items),u(t.totalAmount)}else(0,o.CG)(e),r((0,o.Xl)())}catch(e){m("Failed to update item quantity. Please try again later.")}finally{t(!1)}},E=async(e,t)=>{try{if(t(!0),j){await v.deleteFromCart(j.id,e);let t=await v.viewCart(j.id);r(t.items),u(t.totalAmount)}else(0,o.qY)(e),r((0,o.Xl)())}catch(e){m("Failed to remove product from cart. Please try again later.")}finally{t(!1)}},q=async()=>{x(!0);try{let r=e?.map(e=>({productId:e.productId,quantity:e.quantity})),{order:t}=await (0,c.fS)(j.id,r);console.log(t),w((0,d.Sd)({orders:{orders:t}})),b.push("/checkout")}catch(e){console.error(e),m("Failed to proceed with checkout. Please try again later.")}finally{x(!1)}},S=(e,r)=>{w((0,d.Sd)({id:e})),b.push(`/product/${r}`)};return console.log(e),(0,a.jsx)("div",{className:"bg-gray-100 min-h-screen",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto py-8 px-4 lg:px-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Shopping Cart"}),y?(0,a.jsx)("p",{className:"text-center text-gray-500",children:"Loading..."}):0===e.length?(0,a.jsx)("p",{className:"text-center text-gray-600",children:"Your cart is empty"}):(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2 bg-white rounded shadow-md p-4",children:(0,a.jsx)("ul",{className:"divide-y divide-gray-200",children:e.map((e,r)=>(0,a.jsx)(p,{handleNavigation:S,product:j?e.product:e,onIncreaseQuantity:C,onDecreaseQuantity:N,onRemoveProduct:E,quantity:e?.quantity},r))})}),(0,a.jsxs)("div",{className:"bg-white rounded shadow-md p-4 sticky top-16",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Price Details"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("p",{children:"Price"}),(0,a.jsxs)("p",{children:["$",t?.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,a.jsx)("p",{children:"Discount"}),(0,a.jsx)("p",{children:"- $0.00"})]}),(0,a.jsxs)("div",{className:"flex justify-between font-semibold",children:[(0,a.jsx)("p",{children:"Total Amount"}),(0,a.jsxs)("p",{children:["$",t?.toFixed(2)]})]})]}),(0,a.jsx)("button",{onClick:j?q:()=>{w((0,d.Dh)({route:"/cart"})),b.push("/auth")},className:`w-full mt-4 py-2 rounded text-white ${g?"bg-gray-500":"bg-gray-800 hover:bg-gray-900"}`,disabled:0===e.length||g,children:g?"Processing...":"Checkout"})]})]})]})})};function p({handleNavigation:e,product:r,onIncreaseQuantity:t,onDecreaseQuantity:o,onRemoveProduct:n,quantity:i}){let[l,c]=(0,s.useState)(!1);return(0,a.jsxs)("li",{className:`flex py-4 m-2 ${l?"border-2 border-double border-x-orange-500 animate-pulse ":""}`,children:[(0,a.jsx)("img",{className:"w-16 h-16 rounded object-cover",src:r?.image,alt:r?.name}),(0,a.jsxs)("div",{className:"ml-4 flex-1",children:[(0,a.jsx)("h3",{onClick:()=>e(r?.id,r?.name),className:"text-gray-800 font-semibold",children:r?.name}),(0,a.jsxs)("p",{className:"text-gray-600 text-sm",children:["$",r?.offerPrice?.toFixed(2)," ",(0,a.jsxs)("span",{className:"line-through text-gray-400",children:["$",r?.actualPrice?.toFixed(2)]})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:r?.description}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)("button",{className:"px-3 py-1 bg-gray-200 text-gray-800 rounded-l hover:bg-gray-300",onClick:()=>o(r?.id,c),disabled:l,children:"-"}),(0,a.jsx)("span",{className:"px-4 py-1 bg-gray-100",children:i}),(0,a.jsx)("button",{className:"px-3 py-1 bg-gray-200 text-gray-800 rounded-r hover:bg-gray-300",onClick:()=>t(r?.id,c),disabled:l,children:"+"})]})]}),(0,a.jsx)("button",{className:"ml-auto text-red-500 hover:text-red-600",onClick:()=>n(r?.id,c),disabled:l,children:"Remove"})]})}function h(){return(0,a.jsx)("div",{children:(0,a.jsx)(u,{})})}},13319:(e,r,t)=>{"use strict";t.d(r,{Bj:()=>i,CG:()=>d,Xl:()=>u,o7:()=>c,qY:()=>l});let a="shopflow";function s(){let e=localStorage.getItem(a);return e?JSON.parse(e):[]}function o(e){localStorage.setItem(a,JSON.stringify(e))}function n(e,r){return e.findIndex(e=>e.id===r)}function i(e){let r=s(),t=n(r,e.id);-1===t?r.push({...e,quantity:1}):r[t].quantity+=1,o(r)}function l(e){let r=s();o(r=r.filter(r=>r.id!==e))}function c(e){let r=s(),t=n(r,e);-1!==t&&(r[t].quantity+=1,o(r))}function d(e){let r=s(),t=n(r,e);-1!==t&&(r[t].quantity>1?r[t].quantity-=1:l(e),o(r))}function u(){return s()}},613:(e,r,t)=>{"use strict";t.d(r,{N4:()=>l,TU:()=>n,fS:()=>s,gY:()=>i,p:()=>c,yT:()=>o});var a=t(85209);let s=async(e,r)=>{try{return(await a.S.post("/user/order/createOrder",{userId:e,items:r})).data}catch(e){throw console.error("Error creating order:",e),Error(e?.response?.data?.message||"Error creating order.")}},o=async(e,r,t,s)=>{console.log("order_id:",e),console.log("razorpayId:",r),console.log("paymentId:",t),console.log("siign:",s);try{return(await a.S.post("/user/order/verify",{},{params:{orderId:e,razorpayId:r,paymentId:t,paymentSignature:s}})).data}catch(e){throw console.error("Error verifying payment:",e),Error(e?.response?.data?.message||"Error verifying payment.")}},n=async e=>{console.log("orderid:",e);try{return(await a.S.post(`/user/order/checkoutOrder?orderId=${e}`)).data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}},i=async e=>{console.log("userId:",e);try{return(await a.S.get(`/user/order/getUserOrder?userId=${e}`)).data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}},l=async e=>{console.log(e);try{return(await a.S.put(`/user/order/cancelOrder?orderId=${e}`)).data}catch(e){throw console.error("Error cancelling order:",e),Error(e?.response?.data?.message||"Error cancelling order.")}},c=async e=>{console.log("userId:",e);try{let r=await a.S.get(`/user/order/getOrderById?orderId=${e}`);return console.log(r.data),r.data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}}},26336:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});var a=t(92273),s=t(85209);let o=function(){let e=(0,a.d4)(e=>e.session.token),r="shopflow",t=()=>({Authorization:`Bearer ${e}`,"Content-Type":"application/json"});this.loadCart=function(){let e=localStorage.getItem(r);return e?JSON.parse(e):[]},this.saveCart=function(e){localStorage.setItem(r,JSON.stringify(e))},this.migrateCart=async function(e){let r=this.loadCart();if(console.log(r,e),r.length>0){for(let t of r)try{let r=await this.addItemToCart(e,t.id,t.quantity);console.log("migrated",r)}catch(e){console.error("Error migrating cart item:",e)}this.clearCart()}},this.addItemToCart=async function(e,r,a=1){console.log(e),console.log(r);try{return(await s.S.post("/user/cart/addItemToCart",{},{params:{userId:e,productId:r,quantity:a},headers:t()})).data}catch(e){throw console.log(e),console.error("Error adding item to cart:",e),e.response?e.response.data:Error("Network or server error")}},this.viewCart=async function(e){try{let r=await s.S.get("/user/cart/viewCart",{params:{userId:e},headers:t()});if(200===r.status)return r.data.data||[];throw Error(r.data.message||"Failed to retrieve cart")}catch(e){throw console.error("Error viewing cart:",e),e.response?e.response.data:Error("Network or server error")}},this.deleteFromCart=async function(e,r){try{let a=await s.S.delete("/user/cart/deleteFromCart",{params:{userId:e,productId:r},headers:t()});if(200===a.status)return a.data;throw Error(a.data.message||"Failed to delete item from cart")}catch(e){throw console.error("Error deleting item from cart:",e),e.response?e.response.data:Error("Network or server error")}},this.updateCartCount=async function(e,r,a){try{let o=await s.S.put("/user/cart/cartCount",{},{params:{userId:e,productId:r,operation:a},headers:t()});if(console.log(o.status),200===o.status)return o.data;throw Error(o.data||"Failed to update cart count")}catch(e){throw console.error("Error updating cart count:",e),e}},this.clearCart=function(){localStorage.removeItem(r)}}},14168:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/murali/Documents/Cloning task/shopflow/src/app/cart/page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/murali/Documents/Cloning task/shopflow/src/app/cart/page.js","default")}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[638,803,952],()=>t(4513));module.exports=a})();