{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/murali/Documents/Cloning%20task/shopflow/src/app/service/PaymentService.js"],"sourcesContent":["import { axiosInstance } from \"../api/axios\";\n\nexport const createOrder = async (userId, items) => {\n  try {\n    const response = await axiosInstance.post(\"user/order/createOrder\", {\n      userId,\n      items,\n    });\n    console.log(response);\n\n    if (response.status !== 201) {\n      throw new Error(\"Error creating order\");\n    }\n\n    return response.data; // Return the response data directly\n  } catch (error) {\n    console.error(\"Error in createOrder:\", error);\n    throw error;\n  }\n};\n\nexport const verifyPayment = async (orderId,razorpayId, paymentId, paymentSignature) => {\n    console.log(orderId);\n    console.log(paymentId);\n    console.log(paymentSignature)\n  try {\n    const response = await axiosInstance.post(\"user/order/verify\", {\n    },\n    {\n        params:{\n            razorpayId,\n            orderId,\n            paymentId,\n            paymentSignature,\n        }\n    }\n\n);\n\n\n  \n\n    return response.data; \n  } catch (error) {\n    console.error(\"Error in verifyPayment:\", error);\n    throw error;\n  }\n};\nexport const failedVerify = async (orderId) => {\n    console.log(\"orderid:\",orderId)\n  try { \n    const response = await axiosInstance.post(`/user/order/failedVerify?orderId=${orderId}`);\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching user orders:', error);\n    throw new Error(error?.response?.data?.message || 'Error fetching user orders.');\n  }\n};"],"names":[],"mappings":";;;;;AAAA;;AAEO,MAAM,cAAc,OAAO,QAAQ;IACxC,IAAI;QACF,MAAM,WAAW,MAAM,0HAAA,CAAA,gBAAa,CAAC,IAAI,CAAC,0BAA0B;YAClE;YACA;QACF;QACA,QAAQ,GAAG,CAAC;QAEZ,IAAI,SAAS,MAAM,KAAK,KAAK;YAC3B,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO,SAAS,IAAI,EAAE,oCAAoC;IAC5D,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,MAAM;IACR;AACF;AAEO,MAAM,gBAAgB,OAAO,SAAQ,YAAY,WAAW;IAC/D,QAAQ,GAAG,CAAC;IACZ,QAAQ,GAAG,CAAC;IACZ,QAAQ,GAAG,CAAC;IACd,IAAI;QACF,MAAM,WAAW,MAAM,0HAAA,CAAA,gBAAa,CAAC,IAAI,CAAC,qBAAqB,CAC/D,GACA;YACI,QAAO;gBACH;gBACA;gBACA;gBACA;YACJ;QACJ;QAOA,OAAO,SAAS,IAAI;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,MAAM;IACR;AACF;AACO,MAAM,eAAe,OAAO;IAC/B,QAAQ,GAAG,CAAC,YAAW;IACzB,IAAI;QACF,MAAM,WAAW,MAAM,0HAAA,CAAA,gBAAa,CAAC,IAAI,CAAC,CAAC,iCAAiC,EAAE,SAAS;QACvF,OAAO,SAAS,IAAI;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,MAAM,IAAI,MAAM,OAAO,UAAU,MAAM,WAAW;IACpD;AACF"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///home/murali/Documents/Cloning%20task/shopflow/src/app/service/OrderService.js"],"sourcesContent":["import {axiosInstance} from '../api/axios';\n\nexport const createOrder = async (userId, items) => {\n  try {\n    const response = await axiosInstance.post('/user/order/createOrder', { userId, items });\n    return response.data;\n  } catch (error) {\n    console.error('Error creating order:', error);\n    throw new Error(error?.response?.data?.message || 'Error creating order.');\n  }\n};\n\nexport const verifyPaymentAndUpdateOrder = async (orderId,razorpayId, paymentId, paymentSignature) => {\n    console.log(\"order_id:\",orderId);\n    console.log(\"razorpayId:\",razorpayId);\n    console.log(\"paymentId:\",paymentId);\n    console.log(\"siign:\",paymentSignature);\n  try {\n    const response = await axiosInstance.post('/user/order/verify', {}\n    ,\n    {\n        params:{\n            orderId,\n            razorpayId,\n            paymentId,\n            paymentSignature,\n        }\n    }\n    \n);\n    return response.data;\n  } catch (error) {\n    console.error('Error verifying payment:', error);\n    throw new Error(error?.response?.data?.message || 'Error verifying payment.');\n  }\n};\n\nexport const checkOutOrder = async (orderId) => {\n    console.log(\"orderid:\",orderId)\n  try { \n    const response = await axiosInstance.post(`/user/order/checkoutOrder?orderId=${orderId}`);\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching user orders:', error);\n    throw new Error(error?.response?.data?.message || 'Error fetching user orders.');\n  }\n};\nexport const getOrderByUserId = async (userId) => {\n    console.log(\"userId:\", userId);\n    try {\n      const response = await axiosInstance.get(`/user/order/getUserOrder?userId=${userId}`\n       \n      );\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching user orders:', error);\n      throw new Error(error?.response?.data?.message || 'Error fetching user orders.');\n    }\n  };\nexport const cancelOrder = async (orderId) => {\n    console.log(orderId);\n  try {\n    const response = await axiosInstance.put(`/user/order/cancelOrder?orderId=${orderId}`);\n    return response.data;\n  } catch (error) {\n    console.error('Error cancelling order:', error);\n    throw new Error(error?.response?.data?.message || 'Error cancelling order.');\n  }\n};\n"],"names":[],"mappings":";;;;;;;AAAA;;AAEO,MAAM,cAAc,OAAO,QAAQ;IACxC,IAAI;QACF,MAAM,WAAW,MAAM,0HAAA,CAAA,gBAAa,CAAC,IAAI,CAAC,2BAA2B;YAAE;YAAQ;QAAM;QACrF,OAAO,SAAS,IAAI;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,MAAM,IAAI,MAAM,OAAO,UAAU,MAAM,WAAW;IACpD;AACF;AAEO,MAAM,8BAA8B,OAAO,SAAQ,YAAY,WAAW;IAC7E,QAAQ,GAAG,CAAC,aAAY;IACxB,QAAQ,GAAG,CAAC,eAAc;IAC1B,QAAQ,GAAG,CAAC,cAAa;IACzB,QAAQ,GAAG,CAAC,UAAS;IACvB,IAAI;QACF,MAAM,WAAW,MAAM,0HAAA,CAAA,gBAAa,CAAC,IAAI,CAAC,sBAAsB,CAAC,GAEjE;YACI,QAAO;gBACH;gBACA;gBACA;gBACA;YACJ;QACJ;QAGA,OAAO,SAAS,IAAI;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,MAAM,IAAI,MAAM,OAAO,UAAU,MAAM,WAAW;IACpD;AACF;AAEO,MAAM,gBAAgB,OAAO;IAChC,QAAQ,GAAG,CAAC,YAAW;IACzB,IAAI;QACF,MAAM,WAAW,MAAM,0HAAA,CAAA,gBAAa,CAAC,IAAI,CAAC,CAAC,kCAAkC,EAAE,SAAS;QACxF,OAAO,SAAS,IAAI;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,MAAM,IAAI,MAAM,OAAO,UAAU,MAAM,WAAW;IACpD;AACF;AACO,MAAM,mBAAmB,OAAO;IACnC,QAAQ,GAAG,CAAC,WAAW;IACvB,IAAI;QACF,MAAM,WAAW,MAAM,0HAAA,CAAA,gBAAa,CAAC,GAAG,CAAC,CAAC,gCAAgC,EAAE,QAAQ;QAGpF,OAAO,SAAS,IAAI;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,MAAM,IAAI,MAAM,OAAO,UAAU,MAAM,WAAW;IACpD;AACF;AACK,MAAM,cAAc,OAAO;IAC9B,QAAQ,GAAG,CAAC;IACd,IAAI;QACF,MAAM,WAAW,MAAM,0HAAA,CAAA,gBAAa,CAAC,GAAG,CAAC,CAAC,gCAAgC,EAAE,SAAS;QACrF,OAAO,SAAS,IAAI;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,MAAM,IAAI,MAAM,OAAO,UAAU,MAAM,WAAW;IACpD;AACF"}},
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///home/murali/Documents/Cloning%20task/shopflow/src/app/checkout/Checkout.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { createOrder, failedVerify, verifyPayment } from '../service/PaymentService';  \nimport { checkOutOrder, getOrderById, verifyPaymentAndUpdateOrder } from '../service/OrderService';\nimport { useRouter } from 'next/navigation';\n\nconst OrderSummary = ({ \n  title, \n \n  userId,\n  orders,\n \n  totalBill \n}) => {\n  const router = useRouter();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [orderData, setOrderData] = useState(orders?.orders?.order?.items || orders?.orders?.items);\n  const [formData, setFormData] = useState({\n    fullName: '',\n    streetAddress: '',\n    city: '',\n    state: '',\n    zip: '',\n    country: '',\n  });\n  const [formErrors, setFormErrors] = useState({});\n\n  useEffect(() => {\n    const script = document.createElement('script');\n    script.src = 'https://checkout.razorpay.com/v1/checkout.js';\n    document.body.appendChild(script);\n    return () => {\n      document.body.removeChild(script);\n    };\n  }, [userId]);\n\n  const validateField = (name, value) => {\n    let error = '';\n    if (!value.trim()) {\n      error = `${name.replace(/([A-Z])/g, ' $1')} is required.`;\n    } else {\n      switch (name) {\n        case 'zip':\n          if (!/^[0-9]{5,6}$/.test(value)) {\n            error = 'ZIP code must be 5-6 digits.';\n          }\n          break;\n        case 'fullName':\n          if (value.length < 3) {\n            error = 'Full Name must be at least 3 characters long.';\n          }\n          break;\n        default:\n          break;\n      }\n    }\n    setFormErrors((prevErrors) => ({ ...prevErrors, [name]: error }));\n    return !error;\n  };\n\n  const validateForm = () => {\n    const fields = Object.keys(formData);\n    let isValid = true;\n    fields.forEach((field) => {\n      const valid = validateField(field, formData[field]);\n      if (!valid) isValid = false;\n    });\n    return isValid;\n  };\n  const handleSuccess=()=>{\n    router.push(`/orders/success`);\n\n  }\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData((prevData) => ({\n      ...prevData,\n      [name]: value,\n    }));\n    validateField(name, value);\n  };\n\n  const handlePayment = async () => {\n    if (!validateForm()) {\n      setError('Please fix the highlighted errors before proceeding.');\n      return;\n    }\n  \n    setLoading(true);\n    setError(null);\n  \n    try {\n      const { razorpayOrder, ...data } = await checkOutOrder(orders?.orders?.order?.id || orders?.orders.id);\n      const options = {\n        key: 'rzp_test_nTbKdtgjeOQLhc',\n        amount: Math.ceil(totalBill * 100),\n        currency: razorpayOrder?.currency,\n        name: 'Your Shop',\n        description: 'Payment for your order',\n        order_id: razorpayOrder?.id,\n        handler: async function (response) {\n          const { razorpay_payment_id, razorpay_signature, razorpay_order_id } = response;\n  \n          try {\n            const verificationResult = await verifyPaymentAndUpdateOrder(\n              orders?.orders?.order?.id || orders?.orders.id,\n              razorpay_order_id,\n              razorpay_payment_id,\n              razorpay_signature\n            );\n  \n            if (verificationResult.success) {\n              handleSuccess();\n            } else {\n              await failedVerify(orders?.orders?.order?.id || orders?.orders.id);\n              setError('Payment verification failed. Please try again.');\n            }\n          } catch (error) {\n            setError('An unexpected error occurred during verification. Please try again.');\n          }\n        },\n        prefill: {\n          name: formData.fullName,\n          email: 'customer@example.com',\n          contact: '1234567890',\n        },\n        theme: {\n          color: '#F37254',\n        },\n        modal: {\n          ondismiss: async () => {\n            try {\n              // await failedVerify(orders?.orders?.order?.id || orders?.orders.id);\n              setError('Payment was cancelled by the user. Please try again.');\n            } catch (error) {\n              setError('An error occurred while handling payment cancellation. Please contact support.');\n            }\n          },\n        },\n      };\n  \n      const rzp = new window.Razorpay(options);\n      rzp.open();\n    } catch (err) {\n      setError('Payment process failed. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n  \n  \n  return (\n    <div className=\"bg-gray-100\">\n      {error && <div className=\"bg-red-500 text-white p-4 rounded mb-4\">{error}</div>}\n\n      <div className=\"p-6 shadow-md bg-white\">\n        <h1 className=\"text-xl font-semibold\">{title}</h1>\n        <div className=\"mt-4 grid lg:grid-cols-12 gap-4\">\n\n          <div className=\"lg:col-span-7 bg-white p-4 shadow-sm rounded\">\n            <h2 className=\"text-lg font-medium mb-4\">Delivery Address</h2>\n            {Object.keys(formData)?.map((key) => (\n              <div key={key} className=\"mb-3\">\n                <label className=\"block text-sm font-medium capitalize\" htmlFor={key}>{key.replace(/([A-Z])/g, ' $1')}</label>\n                <input\n                  type=\"text\"\n                  id={key}\n                  name={key}\n                  className={`w-full rounded border p-2 text-sm ${formErrors[key] ? 'border-red-500' : 'border-gray-300'} focus:ring-2 focus:ring-blue-400`}\n                  placeholder={`Enter ${key}`}\n                  value={formData[key]}\n                  onChange={handleInputChange}\n                />\n                {formErrors[key] && <p className=\"text-sm text-red-500 mt-1\">{formErrors[key]}</p>}\n              </div>\n            ))}\n          </div>\n\n          <div className=\"lg:col-span-5 bg-white p-4 shadow-sm rounded\">\n            <h2 className=\"text-lg font-medium mb-4\">Order Summary</h2>\n            {orderData?.map((item, index) => (\n              <div key={index} className=\"flex items-center mb-4\">\n                <img\n                  className=\"w-20 h-20 object-cover rounded border\"\n                  src={item.product?.image || '/_assets/image.png'}\n                  alt={item.product?.name}\n                />\n                <div className=\"ml-4\">\n                  <h3 className=\"text-sm font-medium\">{item.product?.name}</h3>\n                  <p className=\"text-sm text-gray-500\">{item.product?.description}</p>\n                  <p className=\"text-sm font-bold\">${item.product?.offerPrice}</p>\n                </div>\n              </div>\n            ))}\n            <div className=\"border-t pt-4\">\n              <p className=\"font-medium text-lg\">Total: ${totalBill}</p>\n            </div>\n          </div>\n\n        </div>\n\n        <div className=\"mt-6 text-center\">\n          <button\n            className={`w-full p-3 rounded text-white ${loading ? 'bg-gray-500' : 'bg-gray-900'} hover:bg-gray-800`}\n            disabled={loading}\n            onClick={handlePayment}\n          >\n            {loading ? 'Processing...' : 'Proceed to Payment'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default OrderSummary;\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;;AAEA,MAAM,eAAe,CAAC,EACpB,KAAK,EAEL,MAAM,EACN,MAAM,EAEN,SAAS,EACV;IACC,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,QAAQ,QAAQ,OAAO,SAAS,QAAQ,QAAQ;IAC3F,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;QACvC,UAAU;QACV,eAAe;QACf,MAAM;QACN,OAAO;QACP,KAAK;QACL,SAAS;IACX;IACA,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,CAAC;IAE9C,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,SAAS,SAAS,aAAa,CAAC;QACtC,OAAO,GAAG,GAAG;QACb,SAAS,IAAI,CAAC,WAAW,CAAC;QAC1B,OAAO;YACL,SAAS,IAAI,CAAC,WAAW,CAAC;QAC5B;IACF,GAAG;QAAC;KAAO;IAEX,MAAM,gBAAgB,CAAC,MAAM;QAC3B,IAAI,QAAQ;QACZ,IAAI,CAAC,MAAM,IAAI,IAAI;YACjB,QAAQ,GAAG,KAAK,OAAO,CAAC,YAAY,OAAO,aAAa,CAAC;QAC3D,OAAO;YACL,OAAQ;gBACN,KAAK;oBACH,IAAI,CAAC,eAAe,IAAI,CAAC,QAAQ;wBAC/B,QAAQ;oBACV;oBACA;gBACF,KAAK;oBACH,IAAI,MAAM,MAAM,GAAG,GAAG;wBACpB,QAAQ;oBACV;oBACA;gBACF;oBACE;YACJ;QACF;QACA,cAAc,CAAC,aAAe,CAAC;gBAAE,GAAG,UAAU;gBAAE,CAAC,KAAK,EAAE;YAAM,CAAC;QAC/D,OAAO,CAAC;IACV;IAEA,MAAM,eAAe;QACnB,MAAM,SAAS,OAAO,IAAI,CAAC;QAC3B,IAAI,UAAU;QACd,OAAO,OAAO,CAAC,CAAC;YACd,MAAM,QAAQ,cAAc,OAAO,QAAQ,CAAC,MAAM;YAClD,IAAI,CAAC,OAAO,UAAU;QACxB;QACA,OAAO;IACT;IACA,MAAM,gBAAc;QAClB,OAAO,IAAI,CAAC,CAAC,eAAe,CAAC;IAE/B;IACA,MAAM,oBAAoB,CAAC;QACzB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,YAAY,CAAC,WAAa,CAAC;gBACzB,GAAG,QAAQ;gBACX,CAAC,KAAK,EAAE;YACV,CAAC;QACD,cAAc,MAAM;IACtB;IAEA,MAAM,gBAAgB;QACpB,IAAI,CAAC,gBAAgB;YACnB,SAAS;YACT;QACF;QAEA,WAAW;QACX,SAAS;QAET,IAAI;YACF,MAAM,EAAE,aAAa,EAAE,GAAG,MAAM,GAAG,MAAM,CAAA,GAAA,qIAAA,CAAA,gBAAa,AAAD,EAAE,QAAQ,QAAQ,OAAO,MAAM,QAAQ,OAAO;YACnG,MAAM,UAAU;gBACd,KAAK;gBACL,QAAQ,KAAK,IAAI,CAAC,YAAY;gBAC9B,UAAU,eAAe;gBACzB,MAAM;gBACN,aAAa;gBACb,UAAU,eAAe;gBACzB,SAAS,eAAgB,QAAQ;oBAC/B,MAAM,EAAE,mBAAmB,EAAE,kBAAkB,EAAE,iBAAiB,EAAE,GAAG;oBAEvE,IAAI;wBACF,MAAM,qBAAqB,MAAM,CAAA,GAAA,qIAAA,CAAA,8BAA2B,AAAD,EACzD,QAAQ,QAAQ,OAAO,MAAM,QAAQ,OAAO,IAC5C,mBACA,qBACA;wBAGF,IAAI,mBAAmB,OAAO,EAAE;4BAC9B;wBACF,OAAO;4BACL,MAAM,CAAA,GAAA,uIAAA,CAAA,eAAY,AAAD,EAAE,QAAQ,QAAQ,OAAO,MAAM,QAAQ,OAAO;4BAC/D,SAAS;wBACX;oBACF,EAAE,OAAO,OAAO;wBACd,SAAS;oBACX;gBACF;gBACA,SAAS;oBACP,MAAM,SAAS,QAAQ;oBACvB,OAAO;oBACP,SAAS;gBACX;gBACA,OAAO;oBACL,OAAO;gBACT;gBACA,OAAO;oBACL,WAAW;wBACT,IAAI;4BACF,sEAAsE;4BACtE,SAAS;wBACX,EAAE,OAAO,OAAO;4BACd,SAAS;wBACX;oBACF;gBACF;YACF;YAEA,MAAM,MAAM,IAAI,OAAO,QAAQ,CAAC;YAChC,IAAI,IAAI;QACV,EAAE,OAAO,KAAK;YACZ,SAAS;QACX,SAAU;YACR,WAAW;QACb;IACF;IAGA,qBACE,8OAAC;QAAI,WAAU;;YACZ,uBAAS,8OAAC;gBAAI,WAAU;0BAA0C;;;;;;0BAEnE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAyB;;;;;;kCACvC,8OAAC;wBAAI,WAAU;;0CAEb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAG,WAAU;kDAA2B;;;;;;oCACxC,OAAO,IAAI,CAAC,WAAW,IAAI,CAAC,oBAC3B,8OAAC;4CAAc,WAAU;;8DACvB,8OAAC;oDAAM,WAAU;oDAAuC,SAAS;8DAAM,IAAI,OAAO,CAAC,YAAY;;;;;;8DAC/F,8OAAC;oDACC,MAAK;oDACL,IAAI;oDACJ,MAAM;oDACN,WAAW,CAAC,kCAAkC,EAAE,UAAU,CAAC,IAAI,GAAG,mBAAmB,kBAAkB,iCAAiC,CAAC;oDACzI,aAAa,CAAC,MAAM,EAAE,KAAK;oDAC3B,OAAO,QAAQ,CAAC,IAAI;oDACpB,UAAU;;;;;;gDAEX,UAAU,CAAC,IAAI,kBAAI,8OAAC;oDAAE,WAAU;8DAA6B,UAAU,CAAC,IAAI;;;;;;;2CAXrE;;;;;;;;;;;0CAgBd,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAG,WAAU;kDAA2B;;;;;;oCACxC,WAAW,IAAI,CAAC,MAAM,sBACrB,8OAAC;4CAAgB,WAAU;;8DACzB,8OAAC;oDACC,WAAU;oDACV,KAAK,KAAK,OAAO,EAAE,SAAS;oDAC5B,KAAK,KAAK,OAAO,EAAE;;;;;;8DAErB,8OAAC;oDAAI,WAAU;;sEACb,8OAAC;4DAAG,WAAU;sEAAuB,KAAK,OAAO,EAAE;;;;;;sEACnD,8OAAC;4DAAE,WAAU;sEAAyB,KAAK,OAAO,EAAE;;;;;;sEACpD,8OAAC;4DAAE,WAAU;;gEAAoB;gEAAE,KAAK,OAAO,EAAE;;;;;;;;;;;;;;2CAT3C;;;;;kDAaZ,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC;4CAAE,WAAU;;gDAAsB;gDAAS;;;;;;;;;;;;;;;;;;;;;;;;kCAMlD,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BACC,WAAW,CAAC,8BAA8B,EAAE,UAAU,gBAAgB,cAAc,kBAAkB,CAAC;4BACvG,UAAU;4BACV,SAAS;sCAER,UAAU,kBAAkB;;;;;;;;;;;;;;;;;;;;;;;AAMzC;uCAEe"}},
    {"offset": {"line": 489, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 495, "column": 0}, "map": {"version":3,"sources":["file:///home/murali/Documents/Cloning%20task/shopflow/src/app/service/UserCartService.js"],"sourcesContent":["\"use client\";\n\nimport { useSelector } from \"react-redux\";\nimport { axiosInstance } from \"../api/axios\";\n\nfunction UserCartService() {\n  const token = useSelector((state) => state.session.token);\n\n  const cartKey = 'shopflow';\n\n  const getHeaders = () => ({\n    Authorization: `Bearer ${token}`,\n    'Content-Type': 'application/json',\n  });\n\n  this.loadCart = function() {\n    const storedCart = localStorage.getItem(cartKey);\n    return storedCart ? JSON.parse(storedCart) : [];\n  };\n\n  this.saveCart = function(cart) {\n    localStorage.setItem(cartKey, JSON.stringify(cart));\n  };\n\n  this.migrateCart = async function(userId) {\n    const guestCart = this.loadCart();\n    console.log(guestCart,userId);\n    if (guestCart.length > 0) {\n      for (const item of guestCart) {\n        try {\n          const res=await this.addItemToCart(userId, item.id, item.quantity);\n          console.log(\"migrated\",res)\n          \n        } catch (error) {\n          console.error('Error migrating cart item:', error);\n        }\n      }\n      this.clearCart();\n      \n    }\n  };\n\n  this.addItemToCart = async function(userId, productId, quantity = 1) {\n    console.log(userId);\n    console.log(productId);\n    try {\n      const response = await axiosInstance.post(\n        // `/user/cart/addItemToCart?userId=${userId}&productId==${userId}4&quantity=${quantity}`, \n        `/user/cart/addItemToCart`,\n       {},\n        {\n          params:{\n            \n              userId,\n              productId,\n              quantity\n             \n          },\n          headers: getHeaders()\n        }\n      );\n      \n\n        return response.data;\n    \n    \n    } catch (error) {\n      console.log(error)\n      console.error('Error adding item to cart:', error);\n      throw error.response ? error.response.data : new Error('Network or server error');\n    }\n  };\n\n  this.viewCart = async function(userId) {\n    try {\n      const response = await axiosInstance.get('/user/cart/viewCart', {\n        params: { userId },\n        headers: getHeaders(),\n      });\n\n      if (response.status === 200) {\n        return response.data.data || [];\n      } else {\n        throw new Error(response.data.message || 'Failed to retrieve cart');\n      }\n    } catch (error) {\n      console.error('Error viewing cart:', error);\n      throw error.response ? error.response.data : new Error('Network or server error');\n    }\n  };\n\n  this.deleteFromCart = async function(userId, productId) {\n    try {\n      const response = await axiosInstance.delete('/user/cart/deleteFromCart', {\n        params: { userId, productId },\n        headers: getHeaders(),\n      });\n\n      if (response.status === 200) {\n        return response.data;\n      } else {\n        throw new Error(response.data.message || 'Failed to delete item from cart');\n      }\n    } catch (error) {\n      console.error('Error deleting item from cart:', error);\n      throw error.response ? error.response.data : new Error('Network or server error');\n    }\n  };\n\n  this.updateCartCount = async function(userId, productId, operation) {\n    try {\n      const response = await axiosInstance.put('/user/cart/cartCount', {}, {\n        params: { userId, productId, operation },\n        headers: getHeaders(),\n      });\n      console.log(response.status)\n      if (response.status === 200) {\n        return response.data;\n      } else {\n        throw new Error(response.data || 'Failed to update cart count');\n      }\n    } catch (error) {\n      console.error('Error updating cart count:', error);\n      throw error;\n    }\n  };\n\n  this.clearCart = function() {\n    localStorage.removeItem(cartKey);\n  };\n}\n\nexport default UserCartService;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 615, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 621, "column": 0}, "map": {"version":3,"sources":["file:///home/murali/Documents/Cloning%20task/shopflow/src/app/_routeprotector/WithAuth.js"],"sourcesContent":["import { useRouter } from 'next/navigation';\nimport { useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\n\nconst withAuth = (WrappedComponent) => {\n  return (props) => {\n    const router = useRouter();\n    const isLoggedIn = useSelector((state) => state.session.user);\n    const [loading, setLoading] = useState(true);  // Add a loading state\n\n    useEffect(() => {\n      if (isLoggedIn !== undefined) {\n        setLoading(false); \n      }\n    }, [isLoggedIn]);\n\n    useEffect(() => {\n      if (!loading && !isLoggedIn) {\n        router.push('/auth'); \n      }\n    }, [loading, isLoggedIn, router]);\n\n    if (loading) {\n      return <div>Loading.......</div>; \n    }\n\n    return isLoggedIn ? <WrappedComponent {...props} /> : null;\n  };\n};\n\nexport default withAuth;\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;AAEA,MAAM,WAAW,CAAC;IAChB,OAAO,CAAC;QACN,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;QACvB,MAAM,aAAa,CAAA,GAAA,yJAAA,CAAA,cAAW,AAAD,EAAE,CAAC,QAAU,MAAM,OAAO,CAAC,IAAI;QAC5D,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,OAAQ,sBAAsB;QAErE,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;YACR,IAAI,eAAe,WAAW;gBAC5B,WAAW;YACb;QACF,GAAG;YAAC;SAAW;QAEf,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;YACR,IAAI,CAAC,WAAW,CAAC,YAAY;gBAC3B,OAAO,IAAI,CAAC;YACd;QACF,GAAG;YAAC;YAAS;YAAY;SAAO;QAEhC,IAAI,SAAS;YACX,qBAAO,8OAAC;0BAAI;;;;;;QACd;QAEA,OAAO,2BAAa,8OAAC;YAAkB,GAAG,KAAK;;;;;mBAAO;IACxD;AACF;uCAEe"}},
    {"offset": {"line": 672, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 678, "column": 0}, "map": {"version":3,"sources":["file:///home/murali/Documents/Cloning%20task/shopflow/src/app/checkout/page.js"],"sourcesContent":["\"use client\"\nimport React, { useEffect, useState } from 'react';\nimport OrderSummary from './Checkout';  \nimport UserCartService from '../service/UserCartService';\nimport { useSelector } from 'react-redux';\nimport { useSearchParams } from 'next/navigation';\nimport withAuth from '../_routeprotector/WithAuth';\n\n\n\nfunction Page() {\n  const [products, setProducts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const userCartService = new UserCartService();\n  const userId = useSelector((state) => state.session.user?.id);\n  const searchParams = useSearchParams();\n  const orders = useSelector(state=>state?.utils?.product?.orders);\nconsole.log(orders);\n  const fetchProducts = async () => {\n    if (!userId) return;  \n    try {\n      const response = await userCartService.viewCart(userId);\n      console.log(response)\n      const productData = response; \n      setProducts(productData);\n      \n    } catch (error) {\n      console.error(\"Error fetching products:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (userId) {\n      fetchProducts();\n    }\n  }, [userId]);\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <OrderSummary \n      data={products.items} \n      userId={userId}\n      orders={orders}\n      totalBill={products.totalAmount}\n    \n    />\n  );\n}\nexport default withAuth(Page);"],"names":[],"mappings":";;;;AACA;AACA;AACA;AAEA;AACA;AAFA;AAJA;;;;;;;;AAUA,SAAS;IACP,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IAC3C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,kBAAkB,IAAI,wIAAA,CAAA,UAAe;IAC3C,MAAM,SAAS,CAAA,GAAA,yJAAA,CAAA,cAAW,AAAD,EAAE,CAAC,QAAU,MAAM,OAAO,CAAC,IAAI,EAAE;IAC1D,MAAM,eAAe,CAAA,GAAA,kIAAA,CAAA,kBAAe,AAAD;IACnC,MAAM,SAAS,CAAA,GAAA,yJAAA,CAAA,cAAW,AAAD,EAAE,CAAA,QAAO,OAAO,OAAO,SAAS;IAC3D,QAAQ,GAAG,CAAC;IACV,MAAM,gBAAgB;QACpB,IAAI,CAAC,QAAQ;QACb,IAAI;YACF,MAAM,WAAW,MAAM,gBAAgB,QAAQ,CAAC;YAChD,QAAQ,GAAG,CAAC;YACZ,MAAM,cAAc;YACpB,YAAY;QAEd,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;QAC5C,SAAU;YACR,WAAW;QACb;IACF;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,QAAQ;YACV;QACF;IACF,GAAG;QAAC;KAAO;IAEX,IAAI,SAAS;QACX,qBAAO,8OAAC;sBAAI;;;;;;IACd;IAEA,qBACE,8OAAC,kIAAA,CAAA,UAAY;QACX,MAAM,SAAS,KAAK;QACpB,QAAQ;QACR,QAAQ;QACR,WAAW,SAAS,WAAW;;;;;;AAIrC;uCACe,CAAA,GAAA,yIAAA,CAAA,UAAQ,AAAD,EAAE"}},
    {"offset": {"line": 745, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}